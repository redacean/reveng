"use strict";(self.webpackChunkwebsite_reverse_engineering=self.webpackChunkwebsite_reverse_engineering||[]).push([[149],{3905:(e,t,n)=>{n.d(t,{Zo:()=>f,kt:()=>m});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),s=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},f=function(e){var t=s(e.components);return r.createElement(c.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,f=l(e,["components","mdxType","originalType","parentName"]),p=s(n),d=a,m=p["".concat(c,".").concat(d)]||p[d]||u[d]||o;return n?r.createElement(m,i(i({ref:t},f),{},{components:n})):r.createElement(m,i({ref:t},f))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[p]="string"==typeof e?e:a,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6756:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var r=n(7462),a=(n(7294),n(3905));const o={},i="Transformation",l={unversionedId:"ctf/picoctf/transformation",id:"ctf/picoctf/transformation",title:"Transformation",description:"Hello fellow hackers, time to capture the flag! In this challenge we are provided with a file enc and a line of python code ''.join([chr((ord(flag[i]) << 8) + ord(flag[i + 1])) for i in range(0, len(flag), 2)]).",source:"@site/docs/ctf/picoctf/transformation.md",sourceDirName:"ctf/picoctf",slug:"/ctf/picoctf/transformation",permalink:"/reveng/ctf/picoctf/transformation",draft:!1,editUrl:"https://github.com/redacean/reveng/docs/ctf/picoctf/transformation.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"picoCTF",permalink:"/reveng/category/picoctf"}},c={},s=[],f={toc:s},p="wrapper";function u(e){let{components:t,...n}=e;return(0,a.kt)(p,(0,r.Z)({},f,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"transformation"},"Transformation"),(0,a.kt)("p",null,"Hello fellow hackers, time to capture the flag! In this challenge we are provided with a file ",(0,a.kt)("inlineCode",{parentName:"p"},"enc")," and a line of python code ",(0,a.kt)("inlineCode",{parentName:"p"},"''.join([chr((ord(flag[i]) << 8) + ord(flag[i + 1])) for i in range(0, len(flag), 2)])"),"."),(0,a.kt)("p",null,"I first thought the ",(0,a.kt)("inlineCode",{parentName:"p"},"enc")," file was an executable but running the ",(0,a.kt)("inlineCode",{parentName:"p"},"file")," command proved me wrong. Looking at the content of the file shows UTF-8 encoded characters. I unfortunately do not speak mandarin so I asked our friend google translate but it did not seem to be able to make sense of it either."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ file enc\nenc: Unicode text, UTF-8 text, with no line terminators\n$ cat enc\n\u7069\u636f\u4354\u467b\u3136\u5f62\u6974\u735f\u696e\u7374\u3334\u645f\u6f66\u5f38\u5f64\u3532\u6336\u6239\u337d\n")),(0,a.kt)("p",null,"Let's analyse the python code provided. We can confidently assume this was the code used to encrypt the flag and we're asked to analyse the code to recover the flag from the result. The code does the following:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"iterates through the flag string 2 characters by 2 characters,"),(0,a.kt)("li",{parentName:"ul"},"at each iterations it converts the characters to numbers and calculates the sum of:",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"the product of the first element and 256 (shifts its bits by 8 bits to the left) and"),(0,a.kt)("li",{parentName:"ul"},"the second element, and"),(0,a.kt)("li",{parentName:"ul"},"converts the result back to char"))),(0,a.kt)("li",{parentName:"ul"},"joins the result to the encoded flag string")),(0,a.kt)("p",null,"Assuming the flag only contains ASCII characters, the code essentially stores two characters of 8 bits each into 16 bits. Reversing it requires some simple bit manipulation:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"fname = \"enc\"\n\nwith open(fname, 'r') as file:\n    content = file.read() # stores file content as string\n    flag_el = []\n    for i in range(0, len(content)):\n        el1 = ord(content[i]) >> 8 # replaces the first 8 bits by the last 8 bits\n        el2 = ord(content[i]) & 255 # removes the last 8 bits\n        flag_el.append(chr(el1))\n        flag_el.append(chr(el2))\n    flag = ''.join(flag_el)\n    print(flag)\n")),(0,a.kt)("p",null,"And it worked! Feel free to checkout my social links in the footer below. See you in the next one!"))}u.isMDXComponent=!0}}]);